<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Environment Browser - Emergency</title>
    <style>
        body {
            width: 400px;
            min-height: 500px;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: white;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .btn {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-info { background: #17a2b8; color: white; }
        
        .section {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h2>ğŸš¨ ç´§æ€¥ä¿®å¤ç‰ˆæœ¬</h2>
        <p>æ‰€æœ‰åŠŸèƒ½éƒ½é›†æˆåœ¨HTMLä¸­</p>
    </div>
    
    <div class="section">
        <div class="section-title">åŸºç¡€æµ‹è¯•</div>
        
        <button class="btn btn-success" onclick="alert('âœ… JavaScriptæ­£å¸¸å·¥ä½œï¼\næ—¶é—´: ' + new Date().toLocaleString())">
            âœ… JavaScriptæµ‹è¯•
        </button>
        
        <button class="btn btn-info" onclick="
            let msg = 'Browser APIçŠ¶æ€:\n\n';
            msg += 'browserå­˜åœ¨: ' + (typeof browser !== 'undefined') + '\n';
            if (typeof browser !== 'undefined') {
                msg += 'storageå­˜åœ¨: ' + (typeof browser.storage !== 'undefined') + '\n';
                msg += 'storage.localå­˜åœ¨: ' + (typeof browser.storage?.local !== 'undefined') + '\n';
            }
            alert(msg);
        ">
            ğŸ”Œ APIçŠ¶æ€æ£€æŸ¥
        </button>
    </div>
    
    <div class="section">
        <div class="section-title">å­˜å‚¨æ“ä½œ</div>
        
        <button class="btn btn-primary" onclick="
            if (typeof browser === 'undefined' || !browser.storage?.local) {
                alert('âŒ å­˜å‚¨APIä¸å¯ç”¨');
                return;
            }
            browser.storage.local.get(null).then(data => {
                let msg = 'å­˜å‚¨å†…å®¹:\n\n';
                const keys = Object.keys(data);
                if (keys.length === 0) {
                    msg += 'å­˜å‚¨ä¸ºç©º';
                } else {
                    msg += 'å…± ' + keys.length + ' é¡¹:\n';
                    keys.forEach(key => {
                        if (Array.isArray(data[key])) {
                            msg += key + ': æ•°ç»„(' + data[key].length + 'é¡¹)\n';
                        } else {
                            msg += key + ': ' + typeof data[key] + '\n';
                        }
                    });
                }
                alert(msg);
            }).catch(err => {
                alert('âŒ è¯»å–å¤±è´¥: ' + err.message);
            });
        ">
            ğŸ‘ï¸ æŸ¥çœ‹å­˜å‚¨
        </button>
        
        <button class="btn btn-warning" onclick="
            if (typeof browser === 'undefined' || !browser.storage?.local) {
                alert('âŒ å­˜å‚¨APIä¸å¯ç”¨');
                return;
            }
            const name = prompt('ç¯å¢ƒåç§°:', 'ç´§æ€¥æµ‹è¯•ç¯å¢ƒ');
            if (!name) return;
            
            const env = {
                id: 'emergency_' + Date.now(),
                name: name,
                icon: 'ğŸš¨',
                color: '#dc3545',
                description: 'ç´§æ€¥ç‰ˆæœ¬æ·»åŠ çš„ç¯å¢ƒ',
                accountId: '487783143761',
                roleName: 'PowerUserAccess',
                ssoStartUrl: 'https://d-9067f2e3cc.awsapps.com/start/#/console',
                regions: ['us-east-1']
            };
            
            browser.storage.local.get(['aws_environments']).then(result => {
                let envs = result.aws_environments || [];
                envs.push(env);
                return browser.storage.local.set({
                    'aws_environments': envs,
                    'emergency_save': Date.now()
                });
            }).then(() => {
                alert('âœ… ç¯å¢ƒæ·»åŠ æˆåŠŸï¼\nåç§°: ' + env.name + '\nID: ' + env.id);
            }).catch(err => {
                alert('âŒ ä¿å­˜å¤±è´¥: ' + err.message);
            });
        ">
            â• ç´§æ€¥æ·»åŠ ç¯å¢ƒ
        </button>
        
        <button class="btn btn-danger" onclick="
            if (confirm('ç¡®å®šè¦æ¸…ç†æ‰€æœ‰å­˜å‚¨æ•°æ®å—ï¼Ÿ')) {
                browser.storage.local.clear().then(() => {
                    alert('âœ… å­˜å‚¨å·²æ¸…ç†');
                }).catch(err => {
                    alert('âŒ æ¸…ç†å¤±è´¥: ' + err.message);
                });
            }
        ">
            ğŸ—‘ï¸ æ¸…ç†å­˜å‚¨
        </button>
    </div>
    
    <div class="section">
        <div class="section-title">ç¯å¢ƒç®¡ç†</div>
        
        <button class="btn btn-success" onclick="
            const defaultEnvs = [
                {
                    id: 'production',
                    name: 'ç”Ÿäº§ç¯å¢ƒ',
                    icon: 'ğŸ”´',
                    color: '#dc3545',
                    description: 'ç”Ÿäº§ç¯å¢ƒ - è¯·è°¨æ…æ“ä½œ',
                    accountId: '487783143761',
                    roleName: 'PowerUserAccess',
                    regions: ['eu-west-2', 'us-east-1'],
                    ssoStartUrl: 'https://d-9067f2e3cc.awsapps.com/start/#/console'
                },
                {
                    id: 'development',
                    name: 'å¼€å‘ç¯å¢ƒ',
                    icon: 'ğŸŸ¢',
                    color: '#28a745',
                    description: 'å¼€å‘ç¯å¢ƒ - å®‰å…¨æµ‹è¯•',
                    accountId: '487783143761',
                    roleName: 'PowerUserAccess_dev',
                    regions: ['eu-central-1', 'us-west-2'],
                    ssoStartUrl: 'https://d-9067f2e3cc.awsapps.com/start/#/console'
                },
                {
                    id: 'staging',
                    name: 'æµ‹è¯•ç¯å¢ƒ',
                    icon: 'ğŸ”µ',
                    color: '#007bff',
                    description: 'æµ‹è¯•ç¯å¢ƒ - é¢„å‘å¸ƒéªŒè¯',
                    accountId: '487783143761',
                    roleName: 'PowerUserAccess_staging',
                    regions: ['ap-southeast-1', 'ap-northeast-1'],
                    ssoStartUrl: 'https://d-9067f2e3cc.awsapps.com/start/#/console'
                }
            ];
            
            browser.storage.local.set({
                'aws_environments': defaultEnvs,
                'reset_timestamp': Date.now()
            }).then(() => {
                alert('âœ… å·²é‡ç½®ä¸ºé»˜è®¤ç¯å¢ƒï¼\nå…± ' + defaultEnvs.length + ' ä¸ªç¯å¢ƒ');
            }).catch(err => {
                alert('âŒ é‡ç½®å¤±è´¥: ' + err.message);
            });
        ">
            ğŸ”„ é‡ç½®é»˜è®¤ç¯å¢ƒ
        </button>
    </div>
    
    <div class="section">
        <div class="section-title">è¯´æ˜</div>
        <p style="font-size: 12px; line-height: 1.4; margin: 0;">
            è¿™æ˜¯ç´§æ€¥ä¿®å¤ç‰ˆæœ¬ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½ç›´æ¥é›†æˆåœ¨HTMLä¸­ï¼Œä¸ä¾èµ–å¤–éƒ¨JavaScriptæ–‡ä»¶ã€‚
            å¦‚æœè¿™ä¸ªç‰ˆæœ¬å·¥ä½œæ­£å¸¸ï¼Œè¯´æ˜é—®é¢˜å‡ºåœ¨JavaScriptæ–‡ä»¶çš„åŠ è½½æˆ–æ‰§è¡Œä¸Šã€‚
        </p>
    </div>
</body>
</html>
