<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ultimate Test</title>
</head>
<body style="width: 300px; height: 400px; padding: 20px; background: #f0f0f0; font-family: Arial, sans-serif;">
    <h3>ğŸ” ç»ˆææµ‹è¯•</h3>
    
    <p><strong>å¦‚æœæ‚¨èƒ½çœ‹åˆ°è¿™æ®µæ–‡å­—ï¼Œè¯´æ˜HTMLåŠ è½½æ­£å¸¸ã€‚</strong></p>
    
    <div id="jsTest" style="background: #ffcccc; padding: 10px; margin: 10px 0; border-radius: 4px;">
        JavaScriptçŠ¶æ€ï¼šæœªæ‰§è¡Œ
    </div>
    
    <!-- æµ‹è¯•1: æœ€ç®€å•çš„å†…è”äº‹ä»¶ -->
    <button onclick="alert('æµ‹è¯•1æˆåŠŸï¼');" style="width: 100%; padding: 10px; margin: 5px 0; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">
        æµ‹è¯•1: å†…è”onclick
    </button>
    
    <!-- æµ‹è¯•2: å†…è”äº‹ä»¶ + æ§åˆ¶å° -->
    <button onclick="console.log('æµ‹è¯•2è¢«ç‚¹å‡»'); alert('æµ‹è¯•2æˆåŠŸï¼æ§åˆ¶å°æœ‰æ—¥å¿—');" style="width: 100%; padding: 10px; margin: 5px 0; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
        æµ‹è¯•2: å†…è” + æ§åˆ¶å°
    </button>
    
    <!-- æµ‹è¯•3: å†…è”äº‹ä»¶ + DOMæ“ä½œ -->
    <button onclick="document.getElementById('result').innerHTML = 'æµ‹è¯•3æˆåŠŸï¼æ—¶é—´ï¼š' + new Date().toLocaleString(); alert('æµ‹è¯•3æˆåŠŸï¼');" style="width: 100%; padding: 10px; margin: 5px 0; background: #ffc107; color: #212529; border: none; border-radius: 4px; cursor: pointer;">
        æµ‹è¯•3: å†…è” + DOM
    </button>
    
    <!-- æµ‹è¯•4: addEventListenerç»‘å®š -->
    <button id="test4Btn" style="width: 100%; padding: 10px; margin: 5px 0; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">
        æµ‹è¯•4: addEventListener
    </button>
    
    <!-- æµ‹è¯•5: Firefox APIæµ‹è¯• -->
    <button id="test5Btn" style="width: 100%; padding: 10px; margin: 5px 0; background: #6f42c1; color: white; border: none; border-radius: 4px; cursor: pointer;">
        æµ‹è¯•5: Firefox API
    </button>
    
    <div id="result" style="background: #e9ecef; padding: 10px; margin: 10px 0; border-radius: 4px; min-height: 20px;">
        ç»“æœæ˜¾ç¤ºåŒºåŸŸ
    </div>
    
    <div id="apiResult" style="background: #d1ecf1; padding: 10px; margin: 10px 0; border-radius: 4px; min-height: 20px;">
        APIæµ‹è¯•ç»“æœ
    </div>
    
    <script>
        console.log('ğŸ” ç»ˆææµ‹è¯•è„šæœ¬å¼€å§‹æ‰§è¡Œ');
        
        // ç«‹å³æ›´æ–°JavaScriptçŠ¶æ€
        const jsTestDiv = document.getElementById('jsTest');
        if (jsTestDiv) {
            jsTestDiv.innerHTML = 'JavaScriptçŠ¶æ€ï¼šâœ… æ­£å¸¸æ‰§è¡Œ - ' + new Date().toLocaleString();
            jsTestDiv.style.background = '#ccffcc';
        }
        
        // æµ‹è¯•4: addEventListener
        const test4Btn = document.getElementById('test4Btn');
        if (test4Btn) {
            test4Btn.addEventListener('click', function() {
                console.log('æµ‹è¯•4: addEventListenerè¢«ç‚¹å‡»');
                document.getElementById('result').innerHTML = 'æµ‹è¯•4æˆåŠŸï¼addEventListeneræ­£å¸¸å·¥ä½œ - ' + new Date().toLocaleString();
                alert('æµ‹è¯•4æˆåŠŸï¼addEventListeneræ­£å¸¸å·¥ä½œ');
            });
            console.log('âœ… æµ‹è¯•4æŒ‰é’®äº‹ä»¶å·²ç»‘å®š');
        } else {
            console.error('âŒ æ‰¾ä¸åˆ°æµ‹è¯•4æŒ‰é’®');
        }
        
        // æµ‹è¯•5: Firefox API
        const test5Btn = document.getElementById('test5Btn');
        if (test5Btn) {
            test5Btn.addEventListener('click', function() {
                console.log('æµ‹è¯•5: Firefox APIæµ‹è¯•');
                
                let apiInfo = 'Firefox APIæµ‹è¯•ç»“æœï¼š<br>';
                apiInfo += 'browserå­˜åœ¨: ' + (typeof browser !== 'undefined') + '<br>';
                apiInfo += 'chromeå­˜åœ¨: ' + (typeof chrome !== 'undefined') + '<br>';
                
                if (typeof browser !== 'undefined') {
                    apiInfo += 'browser.storageå­˜åœ¨: ' + (typeof browser.storage !== 'undefined') + '<br>';
                    apiInfo += 'browser.storage.localå­˜åœ¨: ' + (typeof browser.storage?.local !== 'undefined') + '<br>';
                    apiInfo += 'browser.tabså­˜åœ¨: ' + (typeof browser.tabs !== 'undefined') + '<br>';
                } else {
                    apiInfo += 'browserå¯¹è±¡ä¸å­˜åœ¨ï¼<br>';
                }
                
                document.getElementById('apiResult').innerHTML = apiInfo;
                
                // å°è¯•ç®€å•çš„å­˜å‚¨æµ‹è¯•
                if (typeof browser !== 'undefined' && browser.storage?.local) {
                    browser.storage.local.set({test_key: 'test_value', test_time: Date.now()})
                        .then(() => {
                            console.log('âœ… å­˜å‚¨æµ‹è¯•æˆåŠŸ');
                            document.getElementById('apiResult').innerHTML += 'å­˜å‚¨æµ‹è¯•: âœ… æˆåŠŸ<br>';
                            alert('æµ‹è¯•5æˆåŠŸï¼Firefox APIæ­£å¸¸å·¥ä½œ');
                        })
                        .catch(error => {
                            console.error('âŒ å­˜å‚¨æµ‹è¯•å¤±è´¥:', error);
                            document.getElementById('apiResult').innerHTML += 'å­˜å‚¨æµ‹è¯•: âŒ å¤±è´¥ - ' + error.message + '<br>';
                            alert('æµ‹è¯•5éƒ¨åˆ†æˆåŠŸï¼APIå­˜åœ¨ä½†å­˜å‚¨å¤±è´¥: ' + error.message);
                        });
                } else {
                    alert('æµ‹è¯•5å¤±è´¥ï¼Firefox APIä¸å¯ç”¨');
                }
            });
            console.log('âœ… æµ‹è¯•5æŒ‰é’®äº‹ä»¶å·²ç»‘å®š');
        } else {
            console.error('âŒ æ‰¾ä¸åˆ°æµ‹è¯•5æŒ‰é’®');
        }
        
        console.log('ğŸ” ç»ˆææµ‹è¯•è„šæœ¬æ‰§è¡Œå®Œæˆ');
        
        // é¢å¤–çš„è¯Šæ–­ä¿¡æ¯
        console.log('é¡µé¢ä¿¡æ¯:');
        console.log('- URL:', window.location.href);
        console.log('- ç”¨æˆ·ä»£ç†:', navigator.userAgent);
        console.log('- æ–‡æ¡£çŠ¶æ€:', document.readyState);
        console.log('- æ‰©å±•ç¯å¢ƒ:', typeof browser !== 'undefined' ? 'WebExtensions' : typeof chrome !== 'undefined' ? 'Chrome Extensions' : 'æ™®é€šç½‘é¡µ');
    </script>
</body>
</html>
